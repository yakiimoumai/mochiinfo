////JSONP
var dee = {
  "de":[
{
	"id":"001",
	"name":"アフガニスタンtest",
	"level":"2"
},{
	"id":"002",
	"name":"アルバニア",
	"level":"3"
},{
	"id":"003",
	"name":"アルジェリア",
	"level":"2"
},{
	"id":"004",
	"name":"アンドラ",
	"level":"3"
},{
	"id":"005",
	"name":"アンゴラ",
	"level":"2"
},{
	"id":"007",
	"name":"アンティグア・バーブーダ",
	"level":"3"
},{
	"id":"008",
	"name":"アルゼンチン",
	"level":"1"
},{
	"id":"009",
	"name":"アルメニア",
	"level":"2"
},{
	"id":"010",
	"name":"アルバ",
	"level":"3"
},{
	"id":"011",
	"name":"オーストラリア",
	"level":"1"
},{
	"id":"012",
	"name":"オーストリア",
	"level":"1"
},{
	"id":"013",
	"name":"アゼルバイジャン",
	"level":"2"
},{
	"id":"014",
	"name":"バハマ",
	"level":"2"
},{
	"id":"015",
	"name":"バーレーン",
	"level":"1"
},{
	"id":"016",
	"name":"バングラデシュ",
	"level":"1"
},{
	"id":"017",
	"name":"バルバドス",
	"level":"3"
},{
	"id":"018",
	"name":"ベラルーシ",
	"level":"2"
},{
	"id":"019",
	"name":"ベルギー",
	"level":"1"
},{
	"id":"020",
	"name":"ベリーズ",
	"level":"2"
},{
	"id":"021",
	"name":"ベナン",
	"level":"3"
},{
	"id":"022",
	"name":"ブータン",
	"level":"1"
},{
	"id":"023",
	"name":"ボリビア",
	"level":"2"
},{
	"id":"024",
	"name":"ボスニア・ヘルツェゴビナ",
	"level":"2"
},{
	"id":"025",
	"name":"ボツワナ",
	"level":"3"
},{
	"id":"026",
	"name":"ブラジル",
	"level":"1"
},{
	"id":"027",
	"name":"ブルネイ",
	"level":"2"
},{
	"id":"028",
	"name":"ブルガリア",
	"level":"1"
},{
	"id":"029",
	"name":"ブルキナファソ",
	"level":"3"
},{
	"id":"030",
	"name":"ブルンジ",
	"level":"3"
},{
	"id":"031",
	"name":"カンボジア",
	"level":"1"
},{
	"id":"032",
	"name":"カメルーン",
	"level":"1"
},{
	"id":"033",
	"name":"カナダ",
	"level":"1"
},{
	"id":"034",
	"name":"カーボベルデ",
	"level":"3"
},{
	"id":"036",
	"name":"中央アフリカ共和国",
	"level":"2"
},{
	"id":"037",
	"name":"チャド",
	"level":"3"
},{
	"id":"038",
	"name":"チリ",
	"level":"1"
},{
	"id":"039",
	"name":"中国",
	"level":"1"
},{
	"id":"040",
	"name":"コロンビア",
	"level":"1"
},{
	"id":"041",
	"name":"コモロ",
	"level":"3"
},{
	"id":"042",
	"name":"コンゴ民主共和党",
	"level":"2"
},{
	"id":"043",
	"name":"コンゴ共和国",
	"level":"2"
},{
	"id":"044",
	"name":"コスタリカ",
	"level":"2"
},{
	"id":"045",
	"name":"コートジボワール",
	"level":"2"
},{
	"id":"046",
	"name":"クロアチア",
	"level":"1"
},{
	"id":"047",
	"name":"キューバ",
	"level":"1"
},{
	"id":"048",
	"name":"キプロス",
	"level":"2"
},{
	"id":"049",
	"name":"チェコ",
	"level":"1"
},{
	"id":"050",
	"name":"デンマーク",
	"level":"1"
},{
	"id":"051",
	"name":"ジブチ",
	"level":"3"
},{
	"id":"052",
	"name":"ドミニカ国",
	"level":"2"
},{
	"id":"053",
	"name":"ドミニカ共和国",
	"level":"2"
},{
	"id":"054",
	"name":"エクアドル",
	"level":"1"
},{
	"id":"055",
	"name":"エジプト",
	"level":"1"
},{
	"id":"056",
	"name":"エルサルバドル",
	"level":"2"
},{
	"id":"057",
	"name":"イングランド",
	"level":"1"
},{
	"id":"058",
	"name":"赤道ギニア",
	"level":"3"
},{
	"id":"059",
	"name":"エリトリア",
	"level":"3"
},{
	"id":"060",
	"name":"エストニア",
	"level":"2"
},{
	"id":"061",
	"name":"エチオピア",
	"level":"2"
},{
	"id":"064",
	"name":"フィジー",
	"level":"2"
},{
	"id":"065",
	"name":"フィンランド",
	"level":"1"
},{
	"id":"066",
	"name":"フランス",
	"level":"1"
},{
	"id":"067",
	"name":"ガボン",
	"level":"3"
},{
	"id":"068",
	"name":"ガンビア",
	"level":"3"
},{
	"id":"069",
	"name":"ジョージア",
	"level":"3"
},{
	"id":"070",
	"name":"ドイツ",
	"level":"1"
},{
	"id":"071",
	"name":"ガーナ",
	"level":"1"
},{
	"id":"073",
	"name":"ギリシャ",
	"level":"1"
},{
	"id":"075",
	"name":"グレナダ",
	"level":"3"
},{
	"id":"076",
	"name":"グアテマラ",
	"level":"2"
},{
	"id":"077",
	"name":"ギニア",
	"level":"2"
},{
	"id":"078",
	"name":"ギニアビサウ",
	"level":"3"
},{
	"id":"079",
	"name":"ガイアナ",
	"level":"3"
},{
	"id":"080",
	"name":"ハイチ",
	"level":"3"
},{
	"id":"081",
	"name":"ホンジュラス",
	"level":"2"
},{
	"id":"082",
	"name":"ハンガリー",
	"level":"1"
},{
	"id":"083",
	"name":"香港",
	"level":"1"
},{
	"id":"084",
	"name":"アイスランド",
	"level":"1"
},{
	"id":"085",
	"name":"インド",
	"level":"1"
},{
	"id":"086",
	"name":"インドネシア",
	"level":"1"
},{
	"id":"087",
	"name":"イラン",
	"level":"1"
},{
	"id":"088",
	"name":"イラク",
	"level":"1"
},{
	"id":"089",
	"name":"アイルランド",
	"level":"2"
},{
	"id":"090",
	"name":"イスラエル",
	"level":"1"
},{
	"id":"091",
	"name":"イタリア",
	"level":"1"
},{
	"id":"092",
	"name":"ジャマイカ",
	"level":"1"
},{
	"id":"093",
	"name":"日本",
	"level":"1"
},{
	"id":"094",
	"name":"ヨルダン",
	"level":"2"
},{
	"id":"095",
	"name":"カザフスタン",
	"level":"2"
},{
	"id":"096",
	"name":"ケニア",
	"level":"1"
},{
	"id":"097",
	"name":"キリバス",
	"level":"3"
},{
	"id":"098",
	"name":"北朝鮮",
	"level":"1"
},{
	"id":"099",
	"name":"大韓民国",
	"level":"1"
},{
	"id":"100",
	"name":"クウェート",
	"level":"2"
},{
	"id":"101",
	"name":"キルギス",
	"level":"2"
},{
	"id":"102",
	"name":"ラオス",
	"level":"2"
},{
	"id":"103",
	"name":"ラトビア",
	"level":"2"
},{
	"id":"104",
	"name":"レバノン",
	"level":"2"
},{
	"id":"105",
	"name":"レソト",
	"level":"3"
},{
	"id":"106",
	"name":"リベリア",
	"level":"2"
},{
	"id":"107",
	"name":"リビア",
	"level":"2"
},{
	"id":"108",
	"name":"リヒテンシュタイン",
	"level":"3"
},{
	"id":"109",
	"name":"リトアニア",
	"level":"2"
},{
	"id":"110",
	"name":"ルクセンブルク",
	"level":"2"
},{
	"id":"111",
	"name":"マカオ",
	"level":"2"
},{
	"id":"112",
	"name":"マケドニア",
	"level":"2"
},{
	"id":"113",
	"name":"マダガスカル",
	"level":"2"
},{
	"id":"114",
	"name":"マラウイ",
	"level":"3"
},{
	"id":"115",
	"name":"マレーシア",
	"level":"1"
},{
	"id":"116",
	"name":"モルディブ",
	"level":"2"
},{
	"id":"117",
	"name":"マリ共和国",
	"level":"2"
},{
	"id":"118",
	"name":"マルタ",
	"level":"2"
},{
	"id":"119",
	"name":"マーシャル諸島",
	"level":"2"
},{
	"id":"120",
	"name":"モーリタニア",
	"level":"2"
},{
	"id":"121",
	"name":"モーリシャス",
	"level":"2"
},{
	"id":"122",
	"name":"メキシコ",
	"level":"1"
},{
	"id":"123",
	"name":"ミクロネシア",
	"level":"2"
},{
	"id":"124",
	"name":"モルドバ",
	"level":"3"
},{
	"id":"125",
	"name":"モナコ",
	"level":"1"
},{
	"id":"126",
	"name":"モンゴル",
	"level":"1"
},{
	"id":"127",
	"name":"モンテネグロ",
	"level":"2"
},{
	"id":"128",
	"name":"モロッコ",
	"level":"1"
},{
	"id":"129",
	"name":"モザンビーク",
	"level":"2"
},{
	"id":"130",
	"name":"ミャンマー",
	"level":"1"
},{
	"id":"131",
	"name":"ナミビア",
	"level":"2"
},{
	"id":"132",
	"name":"ナウル",
	"level":"3"
},{
	"id":"133",
	"name":"ネパール",
	"level":"1"
},{
	"id":"134",
	"name":"オランダ",
	"level":"1"
},{
	"id":"135",
	"name":"ニュージーランド",
	"level":"1"
},{
	"id":"136",
	"name":"ニカラグア",
	"level":"3"
},{
	"id":"137",
	"name":"ニジェール",
	"level":"3"
},{
	"id":"138",
	"name":"ナイジェリア",
	"level":"1"
},{
	"id":"139",
	"name":"ノルウェー",
	"level":"1"
},{
	"id":"140",
	"name":"北アイルランド",
	"level":"1"
},{
	"id":"141",
	"name":"オマーン",
	"level":"2"
},{
	"id":"142",
	"name":"パキスタン",
	"level":"1"
},{
	"id":"143",
	"name":"パラオ",
	"level":"3"
},{
	"id":"144",
	"name":"パレスチナ",
	"level":"2"
},{
	"id":"145",
	"name":"パナマ",
	"level":"2"
},{
	"id":"146",
	"name":"パプアニューギニア",
	"level":"2"
},{
	"id":"147",
	"name":"パラグアイ",
	"level":"1"
},{
	"id":"148",
	"name":"ペルー",
	"level":"1"
},{
	"id":"149",
	"name":"フィリピン",
	"level":"1"
},{
	"id":"150",
	"name":"ポーランド",
	"level":"1"
},{
	"id":"151",
	"name":"ポルトガル",
	"level":"1"
},{
	"id":"152",
	"name":"プエルトリコ",
	"level":"2"
},{
	"id":"153",
	"name":"カタール",
	"level":"2"
},{
	"id":"154",
	"name":"ルーマニア",
	"level":"1"
},{
	"id":"155",
	"name":"ロシア",
	"level":"1"
},{
	"id":"156",
	"name":"ルワンダ",
	"level":"3"
},{
	"id":"157",
	"name":"セントクリストファー・ネイビス",
	"level":"3"
},{
	"id":"158",
	"name":"セントルシア",
	"level":"3"
},{
	"id":"159",
	"name":"セントビンセント・グレナディーン",
	"level":"3"
},{
	"id":"160",
	"name":"サモア",
	"level":"3"
},{
	"id":"161",
	"name":"サンマリノ",
	"level":"2"
},{
	"id":"162",
	"name":"サントメ・プリンシペ",
	"level":"3"
},{
	"id":"163",
	"name":"サウジアラビア",
	"level":"1"
},{
	"id":"164",
	"name":"スコットランド",
	"level":"1"
},{
	"id":"165",
	"name":"セネガル",
	"level":"2"
},{
	"id":"166",
	"name":"セルビア",
	"level":"2"
},{
	"id":"167",
	"name":"セーシェル",
	"level":"3"
},{
	"id":"168",
	"name":"シエラレオネ",
	"level":"3"
},{
	"id":"169",
	"name":"シンガポール",
	"level":"1"
},{
	"id":"170",
	"name":"スロバキア",
	"level":"2"
},{
	"id":"171",
	"name":"スロベニア",
	"level":"2"
},{
	"id":"172",
	"name":"ソロモン諸島",
	"level":"2"
},{
	"id":"173",
	"name":"ソマリア",
	"level":"3"
},{
	"id":"174",
	"name":"南アフリカ",
	"level":"1"
},{
	"id":"175",
	"name":"スペイン",
	"level":"1"
},{
	"id":"176",
	"name":"スリランカ",
	"level":"1"
},{
	"id":"177",
	"name":"スーダン",
	"level":"2"
},{
	"id":"178",
	"name":"スリナム",
	"level":"3"
},{
	"id":"179",
	"name":"スワジランド",
	"level":"3"
},{
	"id":"180",
	"name":"スウェーデン",
	"level":"1"
},{
	"id":"181",
	"name":"スイス",
	"level":"1"
},{
	"id":"182",
	"name":"シリア",
	"level":"2"
},{
	"id":"183",
	"name":"タジキスタン",
	"level":"2"
},{
	"id":"184",
	"name":"タンザニア",
	"level":"2"
},{
	"id":"185",
	"name":"タイ",
	"level":"1"
},{
	"id":"186",
	"name":"東ティモール",
	"level":"2"
},{
	"id":"187",
	"name":"トーゴ",
	"level":"3"
},{
	"id":"188",
	"name":"トンガ",
	"level":"3"
},{
	"id":"189",
	"name":"トリニダード・トバゴ",
	"level":"2"
},{
	"id":"190",
	"name":"チュニジア",
	"level":"2"
},{
	"id":"191",
	"name":"トルコ",
	"level":"1"
},{
	"id":"192",
	"name":"トルクメニスタン",
	"level":"3"
},{
	"id":"193",
	"name":"ツバル",
	"level":"3"
},{
	"id":"194",
	"name":"ウガンダ",
	"level":"2"
},{
	"id":"195",
	"name":"ウクライナ",
	"level":"1"
},{
	"id":"196",
	"name":"アラブ首長国連邦",
	"level":"2"
},{
	"id":"197",
	"name":"イギリス",
	"level":"1"
},{
	"id":"198",
	"name":"アメリカ",
	"level":"1"
},{
	"id":"199",
	"name":"ウルグアイ",
	"level":"2"
},{
	"id":"200",
	"name":"ウズベキスタン",
	"level":"2"
},{
	"id":"201",
	"name":"バヌアツ",
	"level":"3"
},{
	"id":"202",
	"name":"バチカン市国",
	"level":"1"
},{
	"id":"203",
	"name":"ベネズエラ",
	"level":"2"
},{
	"id":"204",
	"name":"ベトナム",
	"level":"1"
},{
	"id":"205",
	"name":"ウェールズ",
	"level":"1"
},{
	"id":"206",
	"name":"西サハラ",
	"level":"3"
},{
	"id":"207",
	"name":"イエメン",
	"level":"2"
},{
	"id":"208",
	"name":"ザンビア",
	"level":"3"
},{
	"id":"209",
	"name":"ジンバブエ",
	"level":"2"
}
]
};


console.log("test01");







	// 国旗データを読み込む
	// function getFlagData() {
	// 	return $.getJSON("flag.json", function(data){});
	// }







// 難易度 デフォルト
var level = "1";

	// クイズ処理（イベント毎に実行したいので関数化）
function drawFlag(level) { //drawFlag(level)start
	// 	getFlagData().done(function(data){


console.log("test02");
mochicallback(dee);

 }//drawFlag(level) end


 //callback
 function mochicallback(dee){ //function mochicallback(dee) start
//とにかくデータが入って来ている

        console.log("test03");
 			//console.log("data.length : ",data.length);
       console.log("dee.de.length : ",dee.de.length);



 			// 難易度調整 国旗データから該当の難易度のみ抽出
 			if (level == "2") {
 				//data = data.filter(function(v){
         data = dee.de.filter(function(v){
 					return v.level == level || v.level == "1";
 				});
 			} else if (level == "3") {
 				//data = data.filter(function(v){
         data = dee.de.filter(function(v){
 					return v.level == level || v.level == "2";
 				});
 			} else {
 				//data = data.filter(function(v){
         data = dee.de.filter(function(v){
 					return v.level == "1";
 				});
 			}

 			// 国旗をランダムに一つ選択する（正解）
 			var q = Math.floor(Math.random() * dee.de.length);
      console.log("dee.de.length test: ",dee.de.length);



 			// 国旗を表示
 			$("#flag").html('<img src="flag_png/flag' + dee.de[q]["id"] + '.png" />');
 			var c = dee.de[q]["id"];
       console.log("c :",c);

 			// 国旗データをシャッフルする
 			var a = [];
 			for (i = dee.de.length - 1; i >= 0; i--) {
         //console.log("i :",i);
 				// 0~iのランダムな数値を取得
 				var rand = Math.floor(Math.random() * (i+1));
         //console.log("rand :",rand);
 				// 配列の数値を入れ替える
 				[dee.de[i], dee.de[rand]] = [dee.de[rand], dee.de[i]]
         //console.log("dee.de[rand] test: ",dee.de[rand]);
 			}

 			// シャッフルした国旗データから先頭の3つを取得
 			for (i = 0; i < 3; i++) {
 				a.push(data[i]);
         console.log("data[i] test1: ",data[i]);

         console.log("a test1: ",a);

 			}

 			// 正解が含まれているか確認し、選択肢を4つにする
 			var d = false;
 			for (i = 0; i < a.length; i++) {
 				if (a[i]["id"] == c) {
 					d = true;
           console.log("select true");
 				}
        console.log("a test2: ",a);
 			}
 			// 含まれていればランダムに一つ追加
 			if (d == true) {
 				a.push(data[3]);
 			// 含まれていなければ正解を追加
       console.log("data[3] test: ",data[3])
 			} else {
 				for (i = 0; i < data.length; i++) {
         //for (i = 0; i < dee.de.length; i++) {
         console.log("data.length test :",data.length);
 					if (data[i]["id"] == c) {
 						a.push(data[i]);
             //console.log("data[i] test1:",data[i]);
 					}
           //console.log("data[i] test2:",data[i]);
 				}
 			}

 			// 選択肢をシャッフルする
 			for (i = a.length - 1; i >= 0; i--) {
 				// 0~iのランダムな数値を取得
 				var rand = Math.floor(Math.random() * (i+1));
         console.log("rand test: ",rand);

 				// 配列の数値を入れ替える
 				[a[i], a[rand]] = [a[rand], a[i]]
 			}

 			// 選択肢を表示
 			for (i = 0; i < a.length; i++) {
 				$("#answer").append('<li id="li' + (i+1) + '"><a id="' + a[i]["id"] + '" href="#">' + a[i]["name"] + '</a></li>');

         console.log("i img test: ",i);
 			}




///////////////操作した時の
 			// 回答を選択時の処理
 			$("#answer a").on("click", function(){

 				// 正解すると次の問題へ
 				if (this.id == c) {
 					// 効果音
 					var audio_o = new Audio("img/audio_o.mp3");
 					audio_o.play();

 					// ボタン変更
 					$(this).css("background","url(img/answer_o.png) no-repeat center");
 					$(this).css("background-size","contain");

 					// 少し時間を置いてから実行
 					setTimeout(function(){
 						$("#answer").empty();
 						$("#level a").off("click");  // イベントをオフにしないと何度もクリックイベントが実行されるので要注意
 						drawFlag(level);
             //mochicallback(dee);
 					}, 250);

           console.log("seikai c test: ",c);

 				// 不正解だと選択肢を削る
 				} else {
 					// 効果音
 					var audio_x = new Audio("img/audio_x.mp3");
 					audio_x.play();

 					// ボタン変更
 					$(this).css("background","url(img/answer_x.png) no-repeat center");
 					$(this).css("background-size","contain");


           console.log("fuseikai c test: ",c);
 				}
 			});

 			// レベル選択
 			$("#level a").on("click", function(){
 				switch(this.id) {
 					case 'level1':
 						level = "1";
 						$("#level1").addClass("active");
 						$("#level2").removeClass("active");
 						$("#level3").removeClass("active");
 						break;
 					case 'level2':
 						level = "2";
 						$("#level2").addClass("active");
 						$("#level1").removeClass("active");
 						$("#level3").removeClass("active");
 						break;
 					case 'level3':
 						level = "3";
 						$("#level3").addClass("active");
 						$("#level1").removeClass("active");
 						$("#level2").removeClass("active");
 						break;
 					default:
 						level = "1";
 						break;
 				}

 				$("#answer").empty();
 				$("#level a").off("click");  // イベントをオフにしないと何度もクリックイベントが実行されるので要注意
 				drawFlag(level);
         //mochicallback(dee);
 			});

 	// 	});
   }//function mochicallback(dee) end


drawFlag(level);
//mochicallback(dee);

console.log("test04");

	//drawFlag(level);

	// 難易度メニュー トグル
	$("#level dd").hide();
	$("#level dt").click(function(){
		$("#level").children("dd").slideToggle("fast");
	});
	$("#level dd").click(function(){
		$("#level dd").hide();
	});
